#!/bin/bash -e

_DOCKER=${1}
_DOCKER_IMAGE_TAG=${2}
_BUILD_DOCKER_CONTEXT=${3}
_BOOTSTRAP_DOCKER_CONTEXT=${4}

"${_DOCKER}" build -t "${_DOCKER_IMAGE_TAG}"-base "${_BUILD_DOCKER_CONTEXT}"
"${_DOCKER}" build -t "${_DOCKER_IMAGE_TAG}" --build-arg BUILDER_BASE="${_DOCKER_IMAGE_TAG}"-base "${_BOOTSTRAP_DOCKER_CONTEXT}"
"${_DOCKER}" push "${_DOCKER_IMAGE_TAG}"
